# -*- coding: utf-8 -*-
"""Day 1 EDA and Y Data Profiling on Titanic Dataset .ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1x6aNOdcACnce2AoZ0_G_cB4JSYfmHtoE
"""

!git clone 'https://github.com/HarshvardhanSingh-13/Datasets'

!pip install ydata-profiling
import pandas as pd
from ydata_profiling import ProfileReport

df = pd.read_csv('/content/Datasets/Titanic_Dataset/Titanic-Dataset.csv')

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

sns.set(style='whitegrid')

df.head()

df.tail()

df.info()

df.isnull().sum()

df.shape

df.describe()

median = df['Age'].median()
print(median)

df['Age'] = df['Age'].fillna(median)

df['Embarked'].mode()[0]
df['Embarked'].fillna(df['Embarked'].mode()[0] ,inplace=True)
df.isnull().sum()

df['Has_Cabin'] = df['Cabin'].notna().astype(int)

df.drop('Cabin',axis=1,inplace=True)
df.head()

df['Has_Cabin'].value_counts()

df.isnull().sum()

fig,axes = plt.subplots(2,3, figsize =(12,10))
fig.suptitle('Univariate Analysis of categorical features')

sns.countplot(ax = axes[0,0], x = 'Survived',data=df ).set_title('Survived')
sns.countplot(ax=axes[0, 1], x='Pclass', data=df).set_title('Passenger Class Distribution')
sns.countplot(ax=axes[0, 2], x='Sex', data=df).set_title('Gender Distribution')
sns.countplot(ax=axes[1, 0], x='Embarked', data=df).set_title('Port of Embarkation')
sns.countplot(ax=axes[1, 1], x='SibSp', data=df).set_title('Siblings/Spouses Aboard')
sns.countplot(ax=axes[1, 2], x='Parch', data=df).set_title('Parents/Children Aboard')

plt.tight_layout(rect=[0, 0, 1, 0.96])
plt.show()

print("\nAnalyzing numerical features:")

fig, axes = plt.subplots(1, 2, figsize=(12, 4))
fig.suptitle('Univariate Analysis of Numerical Features', fontsize=16)

# Plotting Age distribution
sns.histplot(ax=axes[0], data=df, x='Age', kde=True, bins=30).set_title('Age Distribution')

# Plotting Fare distribution
sns.histplot(ax=axes[1], data=df, x='Fare', kde=True, bins=40).set_title('Fare Distribution')

plt.show()

print("bivariate analysis: features vs survied")

fig, axes = plt.subplots(2, 2, figsize=(12, 8))
fig.suptitle('Bivariate Analysis of Features vs. Survived', fontsize=16)

sns.barplot(ax=axes[0, 0], x='Pclass', y='Survived', data=df).set_title('Passenger Class vs. Survival')
sns.barplot(ax=axes[0, 1], x='Sex', y='Survived', data=df).set_title('Gender vs. Survival')
sns.barplot(ax=axes[1, 0], x='Embarked', y='Survived', data=df).set_title('Port of Embarkation vs. Survival')
sns.barplot(ax=axes[1, 1], x='SibSp', y='Survived', data=df).set_title('Siblings/Spouses Aboard vs. Survival')
sns.barplot(ax=axes[1, 1], x='Parch', y='Survived', data=df).set_title('Parents/Children Aboard vs. Survival')

## Age and survival

g = sns.FacetGrid(df,col='Survived',height=5)
g.map(sns.histplot,'Age',bins=25,kde=True)
plt.suptitle('Age Distribution by Survival Status', y=1.02)
plt.show()

plt.figure(figsize=(10, 6))
sns.boxplot(y='Fare',data=df)
plt.title('Box Plot of Ticket Fare')
plt.ylabel('Fare')
plt.show()

## feature engineering

# combining features, extracting from text and binning (for example: age three sub section )

df['FamilySize'] = df['SibSp'] + df['Parch'] + 1
df.head()

df['IsAlone'] = 0
df.loc[df['FamilySize'] == 1, 'IsAlone'] = 1
df.head()

fig, axes = plt.subplots(1, 2, figsize=(12, 5))

sns.barplot(ax=axes[0], x='FamilySize', y='Survived', data=df).set_title('Survival Rate by Family Size')
sns.barplot(ax=axes[1], x='IsAlone', y='Survived', data=df).set_title('Survival Rate for Those Traveling Alone')

plt.show()

df['Name']

## extraction

df['Title'] = df['Name'].str.extract(r' ([A-Za-z]+)\.', expand = False)

df.head()

df['Title'].value_counts()

df['Title'] = df['Title'].replace(['Lady', 'Countess','Capt', 'Col','Don', 'Dr', 'Major', 'Rev', 'Sir', 'Jonkheer', 'Dona'], 'Rare')

df['Title'] = df['Title'].replace('Mlle', 'Miss')
df['Title'] = df['Title'].replace('Ms', 'Miss')
df['Title'] = df['Title'].replace('Mme', 'Mrs')

plt.figure(figsize=(10, 6))
sns.barplot(x='Title', y='Survived', data=df)
plt.title('Survival Rate by Title')
plt.ylabel('Survival Probability')
plt.show()

sns.catplot(x='Pclass', y='Survived', hue='Sex', data=df, kind='bar', height=6, aspect=1.5)
plt.title('Survival Rate by Pclass and Sex')
plt.ylabel('Survival Probability')
plt.show()

plt.figure(figsize=(14, 8))
sns.violinplot(x='Sex', y='Age', hue='Survived', data=df, split=True, palette={0: 'blue', 1: 'orange'})
plt.title('Age Distribution by Sex and Survival')
plt.show()



## Y data profiling

import pandas as pd

from ydata_profiling.utils.cache import cache_file
from ydata_profiling import ProfileReport
import sys

!"{sys.executable}" -m pip install -U ydata-profiling[notebook]
!pip install jupyter-contrib-nbextensions
!jupyter nbextension enable --py widgetsnbextension

# Standard Library Imports
from pathlib import Path

# Installed packages
import pandas as pd
from ipywidgets import widgets

# Our package
from ydata_profiling import ProfileReport
from ydata_profiling.utils.cache import cache_file

# Generate the Profiling Report
profile = ProfileReport(
    df, title="Titanic Dataset", html={"style": {"full_width": True}}, sort=None
)

profile.to_file('titanic_profiling_report.html')

profile



